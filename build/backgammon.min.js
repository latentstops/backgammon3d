var Backgammon3DBoard,Stats=function(){var t=Date.now(),i=t,o=0;return{functions:[],begin:function(){t=Date.now()},end:function(){o++;var t=Date.now(),e=this.interval;return i+e<t&&(this.fps=Math.round(1e3*o/(t-i)),i=t,this.functions.forEach(function(t){if(t){var e=t.func,i=t.scope;e&&i&&e.call(i)}}),o=0),t},update:function(){t=this.end()},interval:3e3}};Backgammon3DBoard=new function(){},function(){function t(){this.init.apply(this,arguments)}t.prototype.initProperties=function(){this.horizontalStep=null,this.verticalStep=null,this.verticalStepOut=null,this.positionMap=null,this.positionMapIterator=null,this.positions={},this.points=null,this.dot=null},t.prototype.init=function(t){this.initProperties(),this.scene=t,this.horizontalStep=.54,this.verticalStep=.48,this.verticalStepOut=.142,this.positionMap=[],this.positionMapIterator=0,this.initPoints(),this.initPositions(),this.initDot()},t.prototype.initDot=function(){this.dot=new THREE.Mesh(new THREE.SphereGeometry(.01),new THREE.MeshLambertMaterial({wireframe:!0}))},t.prototype.initPoints=function(){this.points=new THREE.Object3D,this.points.name="Points"},t.prototype.initPositions=function(){this.positions={rightDownOut:new THREE.Vector3(4.04,.3,2.57),rightDown:new THREE.Vector3(3.3,.04,2.55),leftDown:new THREE.Vector3(-.6,.04,2.55),leftUp:new THREE.Vector3(-3.3,.04,-2.55),rightUp:new THREE.Vector3(.6,.04,-2.55),rightUpOut:new THREE.Vector3(4.04,.3,-2.57),leftDownOut:new THREE.Vector3(-4.04,.3,2.57),leftUpOut:new THREE.Vector3(-4.04,.3,-2.57),hitUp:new THREE.Vector3(0,.31,-1),hitDown:new THREE.Vector3(0,.31,1)}},t.prototype.fillBoard=function(){this.fillRightDownOut(),this.fillRightDown(),this.fillLeftDown(),this.fillLeftUp(),this.fillRightUp(),this.fillRightUpOut(),this.fillHitDown(),this.fillHitUp(),this.fillLeftDownOut(),this.fillLeftUpOut()},t.prototype.fillRightDown=function(){var t=this.positions.rightDown,e={horizontalStep:-this.horizontalStep,verticalStep:-this.verticalStep,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:6};this.fill(e)},t.prototype.fillRightDownOut=function(){var t=this.positions.rightDownOut,e={horizontalStep:-this.horizontalStep,verticalStep:-this.verticalStepOut,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:1};this.fill(e)},t.prototype.fillLeftDown=function(){var t=this.positions.leftDown,e={horizontalStep:-this.horizontalStep,verticalStep:-this.verticalStep,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:6};this.fill(e)},t.prototype.fillLeftDownOut=function(){var t=this.positions.leftDownOut,e={horizontalStep:-this.horizontalStep,verticalStep:-this.verticalStepOut,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:1};this.fill(e)},t.prototype.fillLeftUp=function(){var t=this.positions.leftUp,e={horizontalStep:this.horizontalStep,verticalStep:this.verticalStep,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:6};this.fill(e)},t.prototype.fillLeftUpOut=function(){var t=this.positions.leftUpOut,e={horizontalStep:this.horizontalStep,verticalStep:this.verticalStepOut,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:1};this.fill(e)},t.prototype.fillRightUp=function(){var t=this.positions.rightUp,e={horizontalStep:this.horizontalStep,verticalStep:this.verticalStep,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:6};this.fill(e)},t.prototype.fillRightUpOut=function(){var t=this.positions.rightUpOut,e={horizontalStep:this.horizontalStep,verticalStep:this.verticalStepOut,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:1};this.fill(e)},t.prototype.fillHitUp=function(){var t=this.positions.hitUp,e={horizontalStep:this.horizontalStep,verticalStep:this.verticalStep,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:1};this.fill(e)},t.prototype.fillHitDown=function(){var t=this.positions.hitDown,e={horizontalStep:this.horizontalStep,verticalStep:this.verticalStep,startPosition:t,verticalCheckersCount:15,horizontalCheckersCount:1};this.fill(e)},t.prototype.fill=function(t){var o=this,e=this.dot,i=this.verticalStepOut,n=t.startPosition,a=t.horizontalStep,r=t.verticalStep,s=t.verticalCheckersCount,c=t.horizontalCheckersCount,h=e.clone();h.position.copy(n);this.scene;for(var p=0;p<c;p++){for(var l=0;l<s;l++){var u=h.clone();u.position.copy(h.position),n!=this.positions.hitUp&&n!=this.positions.hitDown?(4<l&&n!=this.positions.hitUp&&n!=this.positions.hitDown&&Math.abs(r)==Math.abs(this.verticalStep)?(u.position.x+=p*a,u.position.z+=4*r,u.position.y+=i):(u.position.x+=p*a,u.position.z+=l*r),m(this.positionMapIterator,u.position)):m(this.positionMapIterator,u.position)}this.positionMapIterator++}function m(t,e){var i=o.positionMap;i[t]||(i[t]=[]),i[t].push(e)}},Backgammon3DBoard.PositionMapGenerator=t}(),function(){function t(t,e){this.manager=t;var i=this.manager.scene,o=i.getObjectByName(this.manager.config.checker.name),n=this.manager.config;this.init(i,o,n,e)}t.prototype.initProperties=function(){this.scaleFactor=null,this.positionMap=null,this.materialMap=null,this.positionMapIterator=null,this.points=null,this.scene=null,this.checker=null,this.mirrorState=0,this.isColorSwitched=0},t.prototype.init=function(t,e,i,o){this.initProperties(),this.scene=t,this.isMirrored=o,this.checker=e,this.checkerGeometryHigh=e.geometry,this.scaleFactor=new THREE.Vector3(.01,.01,.01),this.modelsPath=i,this.initPositionMap(),this.initPoints(),this.initMaterialMap(),this.initCheckerPicker(),this.beautifyChecker()},t.prototype.initPoints=function(){this.points=new THREE.Object3D;var t=this.points;t.name="Points";var e=this.positionMap,i=this.scene;for(var o in e){e[o];var n=new THREE.Object3D;n.name="point",n.index=o,t.add(n)}i.add(t)},t.prototype.initPositionMap=function(){this.isMirrored;this.positionMapGenerator=new Backgammon3DBoard.PositionMapGenerator(this.scene),this.positionMapGenerator.fillBoard(),this.positionMap=this.positionMapGenerator.positionMap.slice(0)},t.prototype.mirrorPositionMap=function(t,e){if(void 0!==t&&this.mirrorState!=t){this.mirrorState=t;var i=this.positionMap,o=i.shift(),n=i.splice(0,12),a=i.splice(0,12);n=n.reverse(),a=a.reverse(),i.unshift.apply(i,a),i.unshift.apply(i,n),i.unshift(o);var r=i[0].slice(0),s=i[25].slice(0);i[0]=i[28],i[28]=r,i[25]=i[29],i[29]=s,this.recalculatePositions(e),this.manager.textWriter.updatePositions(e)}},t.prototype.initMaterialMap=function(){var t={white:14666416,black:2236962},e=new THREE.MeshPhongMaterial({color:t.black});e.shininess=30;var i=new THREE.MeshPhongMaterial({color:t.white});i.shininess=30,this.materialMap=[i,e],this.colorsMap=t},t.prototype.initCheckerPicker=function(){var t=this.manager;this.checkerPicker=new Backgammon3DBoard.CheckerPicker(t,this.positionMap)},t.prototype.beautifyChecker=function(){var t=this.checker;if(t){t.rotateX(-Math.PI/2);var e=new THREE.MeshPhongMaterial;e.shininess=0,e.bumpScale=.01,t.material=e,t.combine=THREE.MixOperation,t.visible=!0,t.castShadow=!0,t.receiveShadow=!0}},t.prototype.recalculatePositions=function(o){var n=this,t=this.scene.getObjectByName("Points"),e=this.manager.textWriter;t.children.forEach(function(t,i){t.children.forEach(function(t,e){n.checkerPicker.movementManager.animateCheckerMove(t,n.positionMap[i][e],i,o)})}),e&&e.updateCheckersCounts()},t.prototype.setCheckersInPoint=function(t,e){var i=this.points.children[t];i.children.length=0;for(var o=this.positionMap[t],n=this.checker,a=this.materialMap,r=0;r<e.length;r++){var s=o[r],c=n.clone();c.material=a[+e[r]],c.position.copy(s),c.index=t,c.readOnly=!0,c.checkerType=+e[r],c.rotation.x="Checker_01.001"==this.manager.config.checker.name?-Math.PI/2:c.rotation.x,0==t&&(c.rotation.x=-Math.PI),25==t&&(c.rotation.x=0),i.children[r]=c}this.manager.textWriter.updateCheckersCounts()},t.prototype.setReadOnly=function(e,i){this.scene.getObjectByName("Points").children.filter(function(t){return 0!=t.children.length&&t.children[t.children.length-1].checkerType==e}).forEach(function(t){t.children.forEach(function(t){t.readOnly=i})})},t.prototype.setPlaceOfOut=function(t,e){this.mirrorState?(this.mirrorPositionMap(0,!1),this.setPlaceOfOutForNormalMode(t,e),this.mirrorPositionMap(1,!1)):this.setPlaceOfOutForNormalMode(t,e)},t.prototype.setPlaceOfOutForNormalMode=function(t,e){var i=this.positionMap,o=this.positionMapGenerator,n=this.manager.textWriter;if(0==t)switch(e){case 2:i[0]=o.positionMap[0].slice(0),i[25]=o.positionMap[25].slice(0);break;case 3:i[0]=o.positionMap[28].slice(0),i[28]=o.positionMap[0].slice(0)}if(1==t)switch(e){case 0:i[25]=o.positionMap[25].slice(0),i[29]=o.positionMap[29].slice(0);break;case 1:i[25]=o.positionMap[29].slice(0),i[29]=o.positionMap[25].slice(0)}n&&n.updatePositions(),this.recalculatePositions()},t.prototype.switchCheckersColors=function(t){t=t||0,this.isColorSwitched=this.isColorSwitched==t?this.isColorSwitched:t;var i=this.isColorSwitched,e=(this.scene,this.colorsMap),o=this.points,n=(new THREE.Color(e.black),new THREE.Color(e.white),this);o.traverse(function(t){if(t instanceof THREE.Mesh){var e=t;1==e.checkerType?e.material=i?n.materialMap[0].clone():n.materialMap[1].clone():e.material=i?n.materialMap[1].clone():n.materialMap[0].clone()}}),this.manager.textWriter.updateCheckersCounts()},t.prototype.fillBoardFromMap=function(){var t=this.scene,e=this.positionMap,i=this.checker,o=this.points,n=(i.material.clone(),new THREE.MeshPhongMaterial({color:2236962})),a=[new THREE.MeshPhongMaterial({color:14666416}),n];for(var r in e){var s=e[r],c=new THREE.Object3D;c.name="point",c.index=r,o.add(c);var h=s[0];if(30!=r){var p=i.clone();p.material=a[r%2],p.position.copy(h),p.index=r,p.checkerType=r%2,c.add(p)}}t.add(o)},Backgammon3DBoard.CheckerManager=t}(),function(){function t(t,e,i,o){this.manager=t,this.init.apply(this,arguments)}t.prototype.initProperties=function(){this.dump={position:[],rotation:[]},this.dumpedAnimation={},this.three=null,this.modelsPath=null,this.texturesMap=null,this.startPosition=null,this.DICE_TEXTURES_PATH=null},t.prototype.init=function(t,e,i,o){this.initProperties(),this.diceType=i,this.startPosition=e.startPosition||{x:0,y:0,z:0},this.three=e.three,this.modelsPath=o,this.DICE_TEXTURES_PATH=this.modelsPath.texturesPath;var n=this;function a(t){return THREE.ImageUtils.loadTexture(n.DICE_TEXTURES_PATH+t)}this.texturesMap={white:{1:a("dice_white/1.png"),2:a("dice_white/2.png"),3:a("dice_white/3.png"),4:a("dice_white/4.png"),5:a("dice_white/5.png"),6:a("dice_white/6.png")},black:{1:a("dice_black/1.png"),2:a("dice_black/2.png"),3:a("dice_black/3.png"),4:a("dice_black/4.png"),5:a("dice_black/5.png"),6:a("dice_black/6.png")},red:{1:a("dice_red/1.png"),2:a("dice_red/2.png"),3:a("dice_red/3.png"),4:a("dice_red/4.png"),5:a("dice_red/5.png"),6:a("dice_red/6.png")}},this.currentTextureMap={}},t.prototype.setStartPosition=function(t,e,i){this.startPosition.x=t,this.startPosition.y=e,this.startPosition.z=i},t.prototype.drop=function(t){switch(t=parseInt(t)){case 1:this.drop1();break;case 2:this.drop2();break;case 3:this.drop3();break;case 4:this.drop4();break;case 5:this.drop5();break;case 6:this.drop6();break;default:this.dropX()}},t.prototype.drop1=function(){var t=this.dumpedAnimation.result;this.setNumber1(t)},t.prototype.drop2=function(){var t=this.dumpedAnimation.result;this.setNumber2(t)},t.prototype.drop3=function(){var t=this.dumpedAnimation.result;this.setNumber3(t)},t.prototype.drop4=function(){var t=this.dumpedAnimation.result;this.setNumber4(t)},t.prototype.drop5=function(){var t=this.dumpedAnimation.result;this.setNumber5(t)},t.prototype.drop6=function(){var t=this.dumpedAnimation.result;this.setNumber6(t)},t.prototype.dropX=function(){var t=this.dumpedAnimation.result;this.setNumber6(t)},t.prototype.setNumber=function(t,e){if(this.three.visible=!1,e=parseInt(e),!isNaN(e))for(var i={1:[1,2,3,6,5,4],2:[2,3,1,5,4,6],3:[3,1,2,4,6,5],4:[4,5,6,3,2,1],5:[5,6,4,2,1,3],6:[6,4,5,1,3,2]},o=this.currentTextureMap,n=i[1].indexOf(e),a=1;a<=6;a++){if(i[a].indexOf(t)==n)this.three.material.map=o[a]}},t.prototype.setCurrentTextureMap=function(t){t=t||"0",this.color=t;var e=this.texturesMap;this.currentTextureMap=e[{0:"white",1:"black",2:"red"}[t]]},t.prototype.setNumber1=function(t){this.setNumber(1,t)},t.prototype.setNumber2=function(t){this.setNumber(2,t)},t.prototype.setNumber3=function(t){this.setNumber(3,t)},t.prototype.setNumber4=function(t){this.setNumber(4,t)},t.prototype.setNumber5=function(t){this.setNumber(5,t)},t.prototype.setNumber6=function(t){this.setNumber(6,t)},t.prototype.setDumpedAnimation=function(t){this.dumpedAnimation=t},t.prototype.playDumpAnimation=function(t,e){this.three.visible=!0;var i=this.dumpedAnimation,o=i.position[t],n=i.rotation[t];if(!o)return!1;if(!n)return!1;this.manager.isAnimated||(o=i.position[i.position.length-1],n=i.rotation[i.rotation.length-1]);var a=new THREE.Vector3,r=new THREE.Vector3,s=this.startPosition.z;switch(a.copy(o),a.y-=.02,r.copy(n),e){case 1:r.copy(n).multiplyScalar(-1),a.x=-a.x,a.z-=s+-.38;break;case 2:a.z-=s+-.38;break;case 0:1==this.diceType&&(r.copy(n).multiplyScalar(-1),a.x=-a.x,a.z-=s+-.38)}return a.y-=.02,this.three.position.copy(a),this.three.rotation.x=r.x,this.three.rotation.y=r.y,this.three.rotation.z=r.z,!0},Backgammon3DBoard.Dice=t}(),function(){function t(t,e,i,o){this.init.apply(this,arguments)}t.prototype.initProperties=function(){this.dices=[],this.animations=[],this.ANIMATION_FILE_ARRAY=[],this.scene=null,this.audio=null,this.params=null,this.modelsPath=null,this.diceGeometry=null,this.animationIndex=null,this.ANIMATIONS_PATH=null,this.DICE_TEXTURES_PATH=null,this.isColorsSwitched=null},t.prototype.init=function(t,e,i,o){this.initProperties();this.manager=t,this.scene=t.scene,this.dices=[],this.diceGeometry=null,this.params=e||{mass:.3,diceParams:{x:.2,y:.2,z:.2}},this.animationIndex=-1,this.isAnimationFromRight=!1,this.modelsPath=i,this.ANIMATIONS_PATH=this.modelsPath.animationsPath,this.DICE_TEXTURES_PATH=this.modelsPath.texturesPath,this.ANIMATION_FILE_ARRAY=["0.json","1.json"],this.initDiceGeometry(),this.initAnimations(o)},t.prototype.createDice=function(t){return new Backgammon3DBoard.Dice(this,{three:this.createTHREE(null)},t,this.modelsPath)},t.prototype.createDices=function(){this.dices.push(this.createDice(1)),this.dices.push(this.createDice(2))},t.prototype.initAnimations=function(t){this.animations=t},t.prototype.initDiceGeometry=function(){var t=this.scene,e=t.getObjectByName("Dice_01")||t.children[0];this.diceGeometry=e.geometry,this.createDices(),this.addToScene(),t.remove(e)},t.prototype.createTHREE=function(t){var n=this,a=(t||this.params).diceParams;a.x,a.y,a.z;if(this.diceGeometry)return function(){var t=n.diceGeometry,e=a.x/3.2;if(n.scaleIndex=e,!t)return;t.computeVertexNormals();var i=new THREE.MeshPhongMaterial;i.map=THREE.ImageUtils.loadTexture(n.DICE_TEXTURES_PATH+"1.png"),i.combine=THREE.MultiplyOperation,i.shininess=50;var o=new THREE.Mesh(t,i);return o.castShadow=!0,o.receiveShadow=!0,o.name="dice",o.scale.set(e,e,e),o.visible=!1,o}();return{}},t.prototype.update=function(t){var e=this.dices[0],i=this.dices[1];e&&i&&(e.three&&i.three&&e.three.mesh&&i.three.mesh&&(e.three=e.three.mesh,i.three=i.three.mesh),e&&i&&e.three.material&&i.three.material&&this.startAnimationHandler(t))},t.prototype.startAnimationHandler=function(t){var e=this.dices[0],i=this.dices[1],o=this.rollType;this.animationIndex<0||(e.playDumpAnimation(this.animationIndex,o)&&i.playDumpAnimation(this.animationIndex,o)||this.stopAnimation(),this.animationIndex+=Math.round(t))},t.prototype.playAnimation=function(t,e){this.isAnimated=e,this.rollType=t,this.animationIndex=0},t.prototype.stopAnimation=function(){this.animationIndex=-10},t.prototype.addToScene=function(){var t=this.dices[0],e=this.dices[1],i=this.scene;i.add(t.three),i.add(e.three)},t.prototype.drop=function(t,e,i,o){this.lastRoll=[t,e],this.scene.getObjectByName("ProjectionObject").renderOrder=10;var n=this.dices[1],a=this.dices[0];a.three.visible=!0,n.three.visible=!0,0!=t&&0!=e&&a&&n&&(this.setDiceColorsFromRollType(i),a.setStartPosition(-10,1,.2),n.setStartPosition(-10,1,.6),a.setDumpedAnimation(this.animations[0]),n.setDumpedAnimation(this.animations[1]),a.drop(t),n.drop(e),this.playAnimation(i,o),this.playSound())},t.prototype.setDiceColorsFromRollType=function(t){t=+t;var e=this.getDice1(),i=this.getDice2(),o=this.manager.checkerManager.isColorSwitched;switch(t){case 0:e.setCurrentTextureMap(o?1:0),i.setCurrentTextureMap(o?0:1);break;case 1:e.setCurrentTextureMap(o?1:0),i.setCurrentTextureMap(o?1:0);break;case 2:e.setCurrentTextureMap(o?0:1),i.setCurrentTextureMap(o?0:1)}},t.prototype.switchDiceColors=function(t){var e=this.getDice1(),i=this.getDice2(),o=+!+e.color+"",n=+!+i.color+"";e.setCurrentTextureMap(o),i.setCurrentTextureMap(n),this.lastRoll&&this.drop(this.lastRoll[0],this.lastRoll[1],this.rollType,!1)},t.prototype.setDiceState=function(t,e){var i=this.getDice(t);i.three.material.transparent=!0,i.three.material.opacity=[1,.4,.2][e]},t.prototype.getDice1=function(){return this.getDice(1)},t.prototype.getDice2=function(){return this.getDice(2)},t.prototype.getDice=function(t){var e=t-1;return this.dices[e]},t.prototype.playSound=function(){},Backgammon3DBoard.DiceManager=t}(),function(){function t(t){this.manager=t;var e=this.manager.scene,i=this.manager.config;this.init(e,i)}t.prototype.init=function(t,e){this.initProperties(),this.scene=t,this.config=e,this.initPositionMap(),this.initPoints(),this.initResetParams(),this.initCube(),this.addToScene(),this.initMovementManager(),this.initDoubleCubePicker(),this.checkDoubleCubeState()},t.prototype.initProperties=function(){this.scene=null,this.config=null,this.cube=null,this.resetParams=null,this.positionMap=null,this.movementManager=null},t.prototype.initCube=function(){var t=this.config.double_cube,e=t.texturesPath,i=this.scene.getObjectByName("dice").geometry.clone(),o=new THREE.MeshPhongMaterial,n=THREE.ImageUtils.loadTexture(e+"cube_black_64.png");n.minFilter=THREE.LinearMipMapLinearFilter,n.anisotropy=this.manager.renderer.getMaxAnisotropy(),o.map=n;var a=new THREE.Mesh(i,o);a.scale.set(.08,.08,.08),a.name=t.name,a.index=t.name,a.castShadow=!0,a.receiveShadow=!0,a.readOnly=!0,a.currentNumber=64,a.exists=!0,this.cube=a,this.reset()},t.prototype.setReadOnly=function(t){this.cube.readOnly=t},t.prototype.reset=function(){var t=this.cube,e=this.resetParams;t.position.copy(e.position),t.rotation.copy(e.rotation)},t.prototype.initResetParams=function(){var t=this.positionMap,e=new THREE.Euler(0,0,0);this.resetParams={position:t[0][0].clone(),rotation:e.clone()}},t.prototype.addToScene=function(){var t=this.scene,e=this.cube;t.add(e)},t.prototype.initMovementManager=function(){this.movementManager=new Backgammon3DBoard.MovementManager(this.manager)},t.prototype.initDoubleCubePicker=function(){this.doubleCubePicker=new Backgammon3DBoard.DoubleCubePicker(this.manager,this.positionMap)},t.prototype.initPoints=function(){this.points=new THREE.Object3D;var t=this.points;t.name="DoubleCubePoints";var e=this.positionMap,i=this.scene;for(var o in e){e[o];var n=new THREE.Object3D;n.name="double-cube-point",n.index=o,t.add(n)}i.add(t)},t.prototype.initPositionMap=function(){var t=new THREE.Vector3(0,.23,0),e=new THREE.Vector3(0,.25,-1.97),i=new THREE.Vector3(0,.25,1.97),o=new THREE.Vector3(-1.97,.23,0),n=new THREE.Vector3(1.97,.23,0);this.positionMap=[[t],[e],[i],[o],[n]]},t.prototype.reversePositionMap=function(){var t=this.positionMap,e=t.shift(),i=t.splice(0,2),o=t.splice(0,2);o=o.reverse(),i=i.reverse(),t.push(e),t.push.apply(t,i),t.push.apply(t,o)},t.prototype.setNumber=function(t,e){var i=this.cube;if(i.currentNumber!=t&&!i.isRotating){"same"==t&&(t=i.currentNumber),i.currentNumber=t;var o=this.manager,n=this.movementManager,a=o.movementManager.boardRotationState,r={64:{z:0,x:0,y:a?-Math.PI:0},2:{z:-Math.PI/2,x:0,y:a?-Math.PI:0},4:{z:Math.PI/2,x:0,y:a?-Math.PI:0},8:{x:Math.PI/2,z:a?Math.PI:0,y:0},16:{x:-Math.PI/2,z:a?-Math.PI:0,y:0},32:{x:Math.PI,z:0,y:a?Math.PI:0}}[t];r&&n.rotateDoubleCube(r,e)}},t.prototype.setDoubleCube=function(t,e,i){this.doubleCubePicker.move({to:t},i),this.setNumber(e,i)},t.prototype.isDoubleCubeExist=function(t){t=t||0,this.cube.exists=t,this.checkDoubleCubeState()},t.prototype.checkDoubleCubeState=function(){var t=this.cube;t.exists=t.exists||!1,t.visible=t.exists},Backgammon3DBoard.DoubleCubeManager=t}(),function(){function t(t){this.manager=t,this.init.apply(this,arguments)}t.prototype.initProperties=function(){this.boardDegreeState=1},t.prototype.init=function(){this.initProperties()},t.prototype.animateCheckerMove=function(t,o,e,i){var n=t.position,a=t.rotation;t.isMoving=!0;var r=i?215:0,s=i?280:0;switch(e){case 0:new TWEEN.Tween(a).to({x:-Math.PI,y:0,z:0},r).easing(TWEEN.Easing.Exponential.Out).start();break;case 25:new TWEEN.Tween(a).to({x:0,y:0,z:0},r).easing(TWEEN.Easing.Exponential.Out).start();break;default:if(!a)break;new TWEEN.Tween(a).to({x:-Math.PI/2,y:0,z:0},r).easing(TWEEN.Easing.Exponential.Out).start()}t.mouseMove||new TWEEN.Tween(n).to({x:o.x,z:o.z},s).easing(TWEEN.Easing.Exponential.Out).onUpdate(function(t){var e=t*Math.PI,i=3*Math.sin(e);i=(i=.5<i?.5:i)<o.y?o.y:i,n.y=i}).onComplete(function(){n.y=o.y,t.isMoving=!1,t.mouseMove=!1}).start(),t.mouseMove&&new TWEEN.Tween(n).to(o,s).easing(TWEEN.Easing.Exponential.Out).onComplete(function(){t.isMoving=!1,t.mouseMove=!1}).start()},t.prototype.rotateBoard=function(t,e){if(this.boardRotationState!=t&&!this.isCameraRotating){this.boardRotationState=t;var i=this.manager.config,o=this.manager.camera,n=this.manager.textWriter,a=o.position.y,r=this.manager.cameraControls.target.clone(),s=i.camera.position.clone(),c=e?1e3:0,h=this;switch(t){case 0:o.position.z=this.boardDegreeState?-s.z:-1e-6;break;case 1:o.position.z=this.boardDegreeState?s.z:1e-6;break;default:return}var p=o.position.z,l={value:0},u=0<t?-Math.PI:Math.PI;this.rotateDoubleCubeWithCamera(e),this.rotateCheckerNumbersWithCamera(e),h.animate(l,{value:u},c,"Linear","None",function(){o.lookAt(r),h.isCameraRotating=!0},function(){o.position.x=p*Math.sin(l.value),o.position.z=p*Math.cos(l.value),o.lookAt(r)},function(){o.lookAt(r),h.isCameraRotating=!1}),e&&h.animate(o.position,{y:22},c/2,"Sinusoidal","InOut",function(){o.lookAt(r)},function(){o.lookAt(r)},function(){h.animate(o.position,{y:a},c/2,"Sinusoidal","In",function(){o.lookAt(r)},function(){o.lookAt(r)},function(){o.lookAt(r)})}),n.updatePositions()}},t.prototype.setBoardDegreeState=function(t,e){if(this.boardDegreeState!=t&&!this.isCameraRotating){this.boardDegreeState=t;var i,o=this.manager,n=this.manager.camera,a=this.manager.config.camera.position.clone(),r=this.manager.cameraControls.target,s=this.boardRotationState;this.manager.textWriter.updatePositions();var c,h=o.config.camera.zoom;switch(t){case 0:i=s?-1e-6:1e-6,c=1.12;break;case 1:i=s?-a.z:a.z,c=h;break;default:return}var p=0<e?600:0;this.animate(n.position,{z:i,x:0},p,"Linear","None",function(){n.lookAt(r)},function(){n.lookAt(r)},function(){n.lookAt(r)}),this.animate(n,{zoom:c},p,"Linear","None",function(){n.updateProjectionMatrix()},function(){n.updateProjectionMatrix()},function(){n.updateProjectionMatrix()})}},t.prototype.animate=function(t,e,i,o,n,a,r,s){new TWEEN.Tween(t).to(e,i).easing(TWEEN.Easing[o][n]).onStart(function(){a&&a()}).onUpdate(function(){r&&r()}).onComplete(function(){s&&s()}).start()},t.prototype.update=function(t){},t.prototype.rotateDoubleCubeWithCamera=function(t){this.manager.doubleCubeManager.setNumber("same",t)},t.prototype.moveDoubleCubeUpDown=function(t){if(t){var e=this,i=this.manager.doubleCubeManager.cube,o=i.position.clone();o.y=.5;var n=i.position.clone();n.y=.23,this.animate(i.position,{y:o.y},500,"Linear","None",null,null,function(){e.animate(i.position,{y:n.y},500,"Linear","None")})}},t.prototype.rotateDoubleCube=function(t,e){var i=this.manager.doubleCubeManager.cube,o=e?1e3:0;this.animate(i.rotation,t,o,"Linear","None",function(){i.isRotating=!0},null,function(){i.isRotating=!1}),this.moveDoubleCubeUpDown(e)},t.prototype.animateDoubleCubeMove=function(t,e,i){var o=this,n=t.position,a=i?400:0,r=i?50:0;o.animate(n,{y:.5},r,"Linear","None",null,null,function(){o.animate(n,{x:e.x,z:e.z},a,"Linear","None",null,null,function(){o.animate(n,{y:.23},r,"Linear","None")})})},t.prototype.rotateCheckerNumbersWithCamera=function(t){var e=this,i=t?1e3:0,o=this.manager.textWriter.points,n=this.boardRotationState?-Math.PI:0;o.traverse(function(t){t instanceof THREE.Mesh&&e.animate(t.rotation,{z:n},i,"Linear","None")})},Backgammon3DBoard.MovementManager=t}(),function(){function t(t,e,i){this.init.apply(this,arguments)}t.prototype.init=function(t,e,i){this.initProperties(t,e,i),this.detect(),this.initRenderer(),this.initCanvas(),this.connectEvents()},t.prototype.initProperties=function(t,e,i){this.domContainer=t,this.eventSource=e,this.config=i,this.isWeb=null,this.isMobile=null,this.canvas=null,this.mouseDowns=[],this.mouseUps=[],this.mouseMoves=[]},t.prototype.detect=function(){try{this.isWeb=void 0!==HTMLDivElement}catch(t){this.isWeb=!1}this.isMobile=this.mobileCheck()},t.prototype.mobileCheck=function(){var t,e=!1;try{t=navigator&&navigator.userAgent||navigator&&navigator.vendor||window&&window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}catch(t){console.log("NO Navigator")}return e},t.prototype.setCoordsFromMobileEvent=function(t){if(this.isMobile){var e=t.touches&&t.touches[0],i=e&&e.clientX,o=e&&e.clientY;t.layerX=i,t.layerY=o}},t.prototype.initRenderer=function(){return this.isWeb?(this.initRendererForWeb(),console.log("IN WEB"),this.isMobile&&console.log("IN MOBILE")):(this.initRendererForQT(),console.log("IN QT")),this.renderer},t.prototype.initRendererForWeb=function(){var t=this.domContainer,e=t.clientWidth,i=t.clientHeight,o=this.config.renderer,n=new THREE.WebGLRenderer({antialias:o.antialias,alpha:o.alpha});n.shadowMap.enabled=!this.isMobile&&o.shadowMap.enabled,n.shadowMap.soft=!this.isMobile&&o.shadowMap.soft,n.setSize(e,i),n.domElement.oncontextmenu=function(){return!1},t.appendChild(n.domElement),this.renderer=n},t.prototype.initRendererForQT=function(){var t=this.domContainer,e=this.config.renderer,i=new THREE.Canvas3DRenderer({antialias:e.antialias,alpha:e.alpha,canvas:t,devicePixelRatio:t.devicePixelRatio});i.setSize(t.width,t.height),i.shadowMapEnabled=e.shadowMap.enabled,i.shadowMapSoft=e.shadowMap.soft,this.renderer=i},t.prototype.addMouseDownFunction=function(t){t&&this.mouseDowns.push(t)},t.prototype.addMouseMoveFunction=function(t){t&&this.mouseMoves.push(t)},t.prototype.addMouseUpFunction=function(t){t&&this.mouseUps.push(t)},t.prototype.connectEvents=function(){this.connectMouseDown(),this.connectMouseMove(),this.connectMouseUp()},t.prototype.removeEvents=function(){this.removeMouseEvents(),this.removeResizeEvent()},t.prototype.removeMouseEvents=function(){if(this.isWeb||this.isMobile){var t=this.mouseMoves,i=this.renderer.domElement,o={0:"touchstart",1:"touchmove",2:"touchend"};t.forEach(function(t,e){i.removeEventListener(o[e],t,!1)})}},t.prototype.removeResizeEvent=function(){(this.isWeb||this.isMobile)&&window.removeEventListener("resize",this.resizeFunction,!1)},t.prototype.connectMouseDown=function(){if(!this.isMouseDownConnected){function t(t){i.setCoordsFromMobileEvent(t);for(var e=0;e<i.mouseDowns.length;e++){(0,i.mouseDowns[e])(t)}}var i=this;if(this.isWeb){var e=this.renderer.domElement;if(this.isMobile)return void e.addEventListener("touchstart",t,!1);e.onmousedown=t}else{this.eventSource.mouseDown.connect(t)}this.isMouseDownConnected=!0}},t.prototype.connectMouseMove=function(){if(!this.isMouseMoveConnected){function t(t){o.isMobile&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()),o.setCoordsFromMobileEvent(t);for(var e=0;e<o.mouseDowns.length;e++){var i=o.mouseMoves[e];o.isWeb&&t.preventDefault(),i(t)}}var o=this;if(this.isWeb){var e=this.renderer.domElement;if(this.isMobile)return void e.addEventListener("touchmove",t,!1);e.onmousemove=t}else{this.eventSource.mouseMove.connect(t)}this.isMouseMoveConnected=!0}},t.prototype.connectMouseUp=function(){if(!this.isMouseUpConnected){function t(t){o.setCoordsFromMobileEvent(t);for(var e=0;e<o.mouseDowns.length;e++){var i=o.mouseUps[e];i(t),i(t)}}var o=this;if(this.isWeb){var e=this.renderer.domElement;if(this.isMobile)return void e.addEventListener("touchend",t,!1);e.onmouseup=t}else{this.eventSource.mouseUp.connect(t)}this.isMouseUpConnected=!0}},t.prototype.connectResize=function(t){var e=this.domContainer;this.resizeFunction=t,this.isWeb?window.addEventListener("resize",t,!1):e.resize_GL.connect(t)},t.prototype.initCanvas=function(){this.isWeb?this.canvas=this.renderer.domElement:this.canvas=this.domContainer},t.prototype.getCanvas=function(){return this.canvas},t.prototype.getRenderer=function(){return this.renderer},Backgammon3DBoard.PlatformDetector=t}(),function(){function t(){this.init.apply(this,arguments)}t.prototype.initProperties=function(){this.loader=null,this.config=null},t.prototype.init=function(t){this.initProperties(),this.config=t,this.loader=new THREE.ObjectLoader},t.prototype.loadAll=function(n){var a=this;this.loadBoard(function(o){a.loadChecker(function(t){var e=a.config.checker.name,i=t.getObjectByName(e);o.add(i),a.loadDice(function(t){var e=a.config.dice.name,i=t.getObjectByName(e);o.add(i),a.loadDiceAnimations(function(t){n&&n(o,t)})})})})},t.prototype.xhrGet=function(t,e,i){var o=new THREE.LoadingManager;new THREE.XHRLoader(o).load(t,e,i)},t.prototype.loadBoard=function(t){var e=this.config.board.objectPath,i=this.config.board.texturesPath,o=this.loader;o.setTexturePath(i),o.load(e,t)},t.prototype.loadChecker=function(t){var e=this.config.checker.objectPath,i=this.config.checker.texturesPath,o=this.loader;o.setTexturePath(i),o.load(e,t)},t.prototype.loadDice=function(t){var e=this.config.dice.objectPath,i=this.config.dice.texturesPath,o=this.loader;o.setTexturePath(i),o.load(e,t)},t.prototype.loadPlane=function(t){var e=this.config.plane.objectPath,i=this.config.plane.texturesPath,o=this.loader;o.setTexturePath(i),o.load(e,t)},t.prototype.loadDiceAnimations=function(i){for(var o=this,n=["0.json","1.json"],a=this.config.dice.animationsPath,r=n.length,s={},t=0;t<r;t++)!function(e){var t=a+n[e];o.xhrGet(t,function(t){t=JSON.parse(t),s[e]=t,Object.keys(s).length==r&&i&&i(s)})}(t)},t.prototype.setTexturePath=function(t){this.loader.setTexturePath.apply(this,arguments)},Backgammon3DBoard.BoardLoader=t}(),function(){function t(){}t.prototype={mouse:new THREE.Vector2,raycaster:new THREE.Raycaster,selectableObjects:[],projectionObject:null,intersectProjection:null,intersectObject:null,clickStarted:Date.now(),timeInterval:0,initParent:function(t){this.scene=t.scene,this.camera=t.camera,this.cameraControls=t.cameraControls,this.platformDetector=t.platformDetector,this.canvas=this.platformDetector.getCanvas(),this.domContainer=this.platformDetector.domContainer,this.initProjectionObject(),this.initEvents()},initProjectionObject:function(){var t=this.scene;this.projectionObject=t.getObjectByName("ProjectionObject")},initEvents:function(){this.addMouseDownEvent(),this.addMouseMoveEvent(),this.addMouseUpEvent()},addMouseDownEvent:function(){var i=this;this.manager.needRendering=!0;this.platformDetector.addMouseDownFunction(function(t){i.manager.needRendering=!0,i.createWebButton(t),i.mouseSet(t),i.raycaster.setFromCamera(i.mouse,i.camera);var e=i.raycaster.intersectObjects(i.selectableObjects,!0);i.intersectObject=e[0],i.intersectObject&&(i.cameraControls.enabled=!1),i.mouseDownCallBack&&i.mouseDownCallBack(t)})},addMouseMoveEvent:function(){var i=this;this.platformDetector.addMouseMoveFunction(function(t){i.manager.needRendering=!0,i.createWebButton(t),i.mouseSet(t),i.raycaster.setFromCamera(i.mouse,i.camera);var e=i.raycaster.intersectObject(i.projectionObject,!0);i.intersectProjection=e[0],i.mouseMoveCallBack&&i.mouseMoveCallBack(t)})},addMouseUpEvent:function(){var e=this;this.platformDetector.addMouseUpFunction(function(t){e.manager.needRendering=!1,e.createWebButton(t),e.mouseUpCallBack&&e.mouseUpCallBack(t),e.intersectObject=null,e.cameraControls.enabled=!0})},mouseSet:function(t){var e=this.canvas;this.mouse.set(t.layerX/e.width*2-1,2*-(t.layerY/e.height)+1)},createWebButton:function(t){void 0===t.webButton&&(t.webButton=t.button||0)},getPlaceInfoFromMesh:function(t){if(t){for(var r=t,e=this.positionMap,s=100,c={position:null,index:null},h=0;h<=27;h++){var i=e[h];if(!i)break;i.forEach(function(t){var e=r.position.x,i=r.position.z,o=t.x-e,n=t.z-i,a=Math.sqrt(Math.pow(o,2)+Math.pow(n,2));a<s&&(s=a,c.index=h,c.position=t)})}return c}}},Backgammon3DBoard.Picker=t}(),function(){function t(t,e){this.manager=t,this.positionMap=e,this.init.apply(this,arguments)}((t.prototype=new Backgammon3DBoard.Picker).constructor=t).prototype.init=function(t){this.scene=t.scene,this.cube=t.scene.getObjectByName("double_cube"),this.initParent(this.manager),this.initProperties(),this.initMovementManager()},t.prototype.initMovementManager=function(){this.movementManager=new Backgammon3DBoard.MovementManager},t.prototype.initProperties=function(){var t=this.scene;this.selectableObjects=[t.getObjectByName("double_cube")]},t.prototype.mouseMoveCallBack=function(){var t=this.selectedCube,e=this.intersectProjection,i=this.manager.cameraControls;t&&e&&(t.object.position.x=e.point.x,t.object.position.y=.5,t.object.position.z=e.point.z,i.enabled=!1)},t.prototype.mouseDownCallBack=function(){var t=this.intersectObject;if(t){if(t.object.readOnly)return;this.selectedCube=t}},t.prototype.mouseUpCallBack=function(){if(this.selectedCube){var t=this.getPlaceInfoFromMesh(this.selectedCube.object);this.doubleCubeMoved(t.index),this.playSound(),this.selectedCube=null}},t.prototype.doubleCubeMoved=function(t){this.move({to:t},!0)},t.prototype.move=function(t,e){if(t){t instanceof Object||(t={to:t});var i=t.to,o=this.positionMap,n=this.cube,a=o[i]&&o[i][0];a&&(n.mapIndex=i,this.movementManager.animateDoubleCubeMove(n,a,e))}},t.prototype.playSound=function(){},Backgammon3DBoard.DoubleCubePicker=t}(),function(){function t(t,e){this.manager=t,this.positionMap=e,this.mouseMoveStarted=!1,this.isMouseDown=!1;var i=this.manager.scene,o=this.manager.camera,n=this.manager.platformDetector;this.init(i,o,n,e)}((t.prototype=Object.create(Backgammon3DBoard.Picker.prototype)).constructor=t).prototype.init=function(t,e,i){this.initParent(this.manager),this.initProperties(),this.initMovementManager()},t.prototype.initProperties=function(){var t=this.scene;this.selectableObjects=t.getObjectByName("Points").children,this.lastMouseCoords=new THREE.Vector2},t.prototype.initMovementManager=function(){this.movementManager=new Backgammon3DBoard.MovementManager},t.prototype.mouseMoveCallBack=function(t){if(this.mouseMoveStarted=this.mouseMoveStarted?this.mouseMoveStarted:!this.mouseMoveStarted,(!this.isMouseInsideCircle()||this.isCheckerMoveStarted)&&this.selectedChecker&&!(0!==t.webButton||1<t.buttons)){var e=this.selectedChecker,i=this.intersectProjection;i&&(this.selectedChecker.object.mouseMove=!0,e.object.position.x=i.point.x,e.object.position.y=.5,e.object.position.z=i.point.z,this.mouseMoveStarted&&!this.isCheckerMoveStarted&&this.mouseMoveStart(),this.isCheckerMoveStarted=!0)}},t.prototype.mouseMoveStart=function(){this.selectedChecker.object.rotation.x=-Math.PI/2,this.manager.textWriter.updateCheckersCounts()},t.prototype.mouseDownCallBack=function(t){this.lastMouseCoords=this.mouse.clone();var e=this;this.manager.scene;this.isMouseDown=!0;var i=e.intersectObject;if(i){var o=i.object.index,n=e.selectableObjects[o].children.length,a={object:e.selectableObjects[o].children[n-1]};if(a.object.readOnly)return;if(a.object.isMoving)return;e.selectedChecker=a,e.platformDetector.isMobile&&(window.navigator.vibrate=window.navigator.vibrate||function(){}),e.platformDetector.isMobile&&window.navigator.vibrate(10);var r=e.selectableObjects[o].children.indexOf(e.selectedChecker.object),s=e.selectableObjects[o].children.splice(r,1)[0];e.selectableObjects[o].children.push(s),e.manager.gameHelper&&e.manager.gameHelper.turnLightOnFromMesh(a.object)}},t.prototype.allPossibleSteps=function(t){var e=this;setTimeout(function(){e.move({from:t,to:t},!0)},200)},t.prototype.maxStep=function(t){var e=this;setTimeout(function(){e.move({from:t,to:t+2},!0)},200)},t.prototype.minStep=function(t){var e=this;setTimeout(function(){e.move({from:t,to:t-2},!0)},200)},t.prototype.resetEventsParams=function(){this.isMouseDown=!1,this.selectedChecker=null,this.mouseMoveStarted=!1,this.isCheckerMoveStarted=!1},t.prototype.mouseUpCallBack=function(t){var e=this,i=e.selectedChecker;if(e.manager.gameHelper&&e.manager.gameHelper.turnOffAllLights(),i){var o=e.getPlaceInfoFromMesh(i.object).index,n=i.object.index,a={from:n,to:o};this.manager.diceManager;if(1===t.webButton)return e.resetEventsParams(),void e.allPossibleSteps(n);if(2===t.webButton)return e.resetEventsParams(),void e.minStep(n);if(e.isMouseInsideCircle()&&!e.isCheckerMoveStarted)return e.resetEventsParams(),e.maxStep(n),void this.manager.textWriter.updateCheckersCounts();e.resetEventsParams(),e.moved(a.from,a.to),e.playSound()}},t.prototype.isMouseInsideCircle=function(){var t=this.mouse.x,e=this.lastMouseCoords.x,i=this.mouse.y,o=this.lastMouseCoords.y;return Math.sqrt(Math.pow(t-e,2)+Math.pow(i-o,2))<.02},t.prototype.moveCollection=function(t,e){for(;t.length;){var i=t.splice(0,2),o={from:i[0],to:i[1]};this.move(o,e)}},t.prototype.move=function(t,e){var i=t.from,o=t.to,n=i==o,a=this.selectedChecker&&this.selectedChecker.object||this.getCheckerFromIndex(i);if(this.resetEventsParams(),a){var r=this.getPositionFromIndex(o,n);if(r)this.replaceChecker(i,o),this.animateMove(a,r,o,e),this.manager.textWriter.updateCheckersCounts()}},t.prototype.moved=function(t,e){this.moveCollection([t,e],!0)},t.prototype.replaceChecker=function(t,e){var i=this.selectableObjects[t].children,o=this.selectableObjects[e].children,n=this.getCheckerFromIndex(t);n.index=e;var a=i.indexOf(n);i.splice(a,1),o.push(n)},t.prototype.animateMove=function(t,e,i,o){this.movementManager.animateCheckerMove.apply(this,arguments)},t.prototype.getCheckerFromIndex=function(t){var e,i=this.selectableObjects[t].children;return(e=i)[e.length-1]},t.prototype.getPositionFromIndex=function(t,e){var i=this.positionMap,o=this.selectableObjects[t]&&this.selectableObjects[t].children;if(o)return e?i[t][o.length-1]:i[t][o.length]},t.prototype.playSound=function(){},Backgammon3DBoard.CheckerPicker=t}(),function(){function t(t){this.init.apply(this,arguments)}t.prototype.initProperties=function(){this.manager=null,this.sprite=null,this.numbers=[]},t.prototype.init=function(t){this.initProperties(),this.manager=t,this.initPositionMap(),this.initPoints(),this.initObjects(),this.addToScene()},t.prototype.initPositionMap=function(){var t=this.manager.checkerManager.positionMap[0][0].clone(),e=this.manager.checkerManager.positionMap[25][0].clone();t.z=0<t.z?t.z+.6:t-.6,e.z=e.z<0?e.z-.6:e+.6,this.pipsMap={pips1:t,pips2:e},this.positionMap=this.manager.checkerManager.positionMap},t.prototype.initObjects=function(){var t=new THREE.MeshBasicMaterial({color:7435910}),e=this.getGeometryFromText(" 1 "),i=this.getGeometryFromText(" 2 "),o=new THREE.Mesh(e,t);o.name="pips1",o.scale.set(.12,.12,.012),o.rotateX(-Math.PI/4),o.castShadow=!0,o.receiveShadow=!0;var n=o.clone();n.geometry=i,n.name="pips2",n.position.copy(this.pipsMap.pips2),this.objects=[o,n],this.updatePositions(),this.hidePips()},t.prototype.hidePips=function(){this.setPipsVisibiliyState(!1)},t.prototype.showPips=function(){this.setPipsVisibiliyState(!0)},t.prototype.setPipsVisibiliyState=function(t){var e=this.getPips1(),i=this.getPips2();e.visible=t,i.visible=t},t.prototype.updatePositions=function(t){var e=this.manager.movementManager,i=e.boardDegreeState,o=e.boardRotationState;this.initPositionMap();var n=this.getPips1(),a=this.getPips2();n.rotation.x=-Math.PI/3,a.rotation.x=-Math.PI/3,n.rotation.y=0,a.rotation.y=0,i?(n.rotation.x=-Math.PI/3,a.rotation.x=-Math.PI/3):(n.rotation.x=-Math.PI/2,a.rotation.x=-Math.PI/2),o?(n.rotation.y=Math.PI,a.rotation.y=Math.PI):(n.rotation.y=0,a.rotation.y=0),i&&o&&(n.rotation.x=Math.PI/3,a.rotation.x=Math.PI/3,n.rotation.y=Math.PI,a.rotation.y=Math.PI),!i&&o&&(n.rotation.x=Math.PI/2,a.rotation.x=Math.PI/2),n.position.copy(this.pipsMap.pips1),a.position.copy(this.pipsMap.pips2)},t.prototype.addToScene=function(){var t=this.manager.scene;t.add(this.objects[0]),t.add(this.objects[1])},t.prototype.getMeshFromGeometry=function(t,e,i){var o=this.manager.checkerManager.isColorSwitched,n=[14666416,0],a=new THREE.MeshBasicMaterial({color:n[o?0:1]}),r=new THREE.MeshBasicMaterial({color:n[o?1:0]}),s=e?{0:a,1:r}[e]:a,c=new THREE.Mesh(t,s);return i&&c.scale.set(.15,.15,.01)||c.scale.set(.16,.16,.01),c.rotateX(-Math.PI/2),c},t.prototype.getGeometryFromText=function(t){var e=new THREE.TextGeometry(t,{size:1,height:1,curveSegments:3,font:"helvetiker"});return e.center(),e},t.prototype.updateCheckersCounts=function(){var p,l=this,t=this.manager.checkerManager.positionMap,u=this.manager.checkerManager.checkerPicker.selectableObjects,m=this.points,e=this.manager.checkerManager.checkerPicker.selectedChecker,d=e&&e.object.index,f=d?1:0;t.forEach(function(t,e){var i,o=u[e].children.length,n=e==d?o-f:o;if(i=26==e||27==e?1<n?n:null:5<n?n:null,0!=e&&25!=e)if(null!==i){var a=1<(i+"").length,r=l.getGeometryFromText(i),s=u[e].children[0].checkerType,c=l.getMeshFromGeometry(r,s,a);c.rotation.z=l.manager.movementManager.boardRotationState?-Math.PI:0;var h=t[6].clone();h.y+=.15,(p=m.children[e]).children=[],p.children.length=0,c.position.copy(h),c.index=e,p.add(c)}else(p=m.children[e]).children=[],p.children.length=0})},t.prototype.initPoints=function(){this.points=new THREE.Object3D;var t=this.points;t.name="Points";var e=this.positionMap,i=this.manager.scene;for(var o in e){e[o];var n=new THREE.Object3D;n.name="point",n.index=o,t.add(n)}i.add(t)},t.prototype.write=function(t,e){var i=this.manager.scene,o=t;isNaN(+t)||(o=t?"pips1":"pips2"),i.getObjectByName(o).geometry=this.getGeometryFromText(e)},t.prototype.getPips1=function(){return this.getPips(1)},t.prototype.getPips2=function(){return this.getPips(2)},t.prototype.getPips=function(t){return this.objects[t-1]},Backgammon3DBoard.TextWriter=t}(),function(){function t(t){this.demo=!1,this.manager=t,this.init(t)}t.prototype.init=function(t){this.scene=t.scene,this.checkerManager=t.checkerManager,this.positionMap=t.checkerManager.positionMap,this.initProperties()},t.prototype.initProperties=function(){this.initPoint(),this.createPoints()},t.prototype.initPoint=function(){var t=new THREE.SphereGeometry(.05,10,10),e=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:65280}));this.point=e},t.prototype.createPoints=function(){this.points&&this.scene.remove(this.points);var t=new THREE.Object3D,e=new THREE.Object3D,i=this.point,o=this.positionMap,n=this.scene,a=new THREE.MeshBasicMaterial({color:0});a.transparent=!0,a.opacity=.6;for(var r=0;r<=25;r++){var s=o[r][0].clone(),c=s.z;s.z=0<c?c+.35:c-.35,s.y=.27;var h=i.clone();h.position.copy(s),h.visible=!1;var p=i.clone();p.material=a.clone(),p.position.copy(s),p.visible=!1,p.scale.set(.99,.99,.99),t.add(h),e.add(p)}n.add(t),n.add(e),this.points=t,this.points2=e},t.prototype.turnLightOnForIndex=function(t){this.changeLightState(t,!0)},t.prototype.turnLightOffForIndex=function(t){this.changeLightState(t,!1)},t.prototype.changeLightState=function(t,e){if(this.manager.platformDetector.isMobile){var i=this.points.children[t];i&&(i.visible=e)}},t.prototype.turnLightOnFromMesh=function(t){if(this.demo&&this.manager.platformDetector.isMobile){var e=this.manager,i=e.diceManager,o=e.checkerManager.checkerPicker,n=this.points.children,a=o.getPlaceInfoFromMesh(t).index,r=i.lastRoll||[],s=a+r[1],c=n[a+r[0]],h=n[s];this.turnOffAllLights(),c&&(c.visible=!0),h&&(h.visible=!0)}},t.prototype.turnOffAllLights=function(){this.turnLightsOn(!1)},t.prototype.turnLightsOn=function(e){this.points.children.forEach(function(t){t.visible=e})},t.prototype.turnOnOff=function(){var t=this.points,e=(this.points,Math.round(25*Math.random()));t.children[e].visible=!t.children[e].visible},t.prototype.short=function(){var t=this.checkerManager;t.setCheckersInPoint(1,[1,1]),t.setCheckersInPoint(6,[0,0,0,0,0]),t.setCheckersInPoint(8,[0,0,0]),t.setCheckersInPoint(12,[1,1,1,1,1]),t.setCheckersInPoint(13,[0,0,0,0,0]),t.setCheckersInPoint(17,[1,1,1]),t.setCheckersInPoint(19,[1,1,1,1,1]),t.setCheckersInPoint(24,[0,0])},Backgammon3DBoard.GameHelper=t}(),function(){function t(t){this.init.apply(this,arguments)}t.prototype={init:function(t){this.manager=t,this.priority=0,this.initConfig(),this.checkersOptimizationDone=!1,this.textureOptimizationDone=!1,this.shadowsOptimizationDone=!1,this.interval=3e3,this.manager.stats.functions=[{func:this.update,scope:this}],this.initOptimizations()},initConfig:function(){this.config={FPS_MIN:30,FPS_MAX:45}},initOptimizations:function(){var t=[],e=this.manager.platformDetector.isWeb;t.push({isOptimized:!1,scope:this,func:this.optimizeShadows}),e&&t.push({isOptimized:!1,scope:this,func:this.optimizeCheckers}),t.push({isOptimized:!1,scope:this,func:this.optimizeTextures}),this.optimizations=t},optimizeNext:function(){this.manipulateOptimization(!1)},manipulateOptimization:function(t){var e=this.optimizations;for(var i in e){var o=e[i];if(o.isOptimized==t){var n=o.func,a=o.scope;n.call(a,t),o.isOptimized=!t;break}}},revertOptimizationNext:function(){this.manipulateOptimization(!0)},update:function(){var t=this.config,e=this.manager.stats.fps;this.manager.scene&&(t.FPS_MIN>e?this.optimizeNext():e>t.FPS_MAX&&this.revertOptimizationNext())},optimizeShadows:function(t){var e=this.manager,i=e.stats,o=e.scene;if(i){var n=o.getObjectByName("dLight2");i.fps,this.config;t?(n.castShadow=!0,n.shadowDarkness=.3):(n.castShadow=!(0==n.shadowDarkness),n.shadowDarkness=0)}},optimizeCheckers:function(t){var i=this,e=this.manager,o=(e.stats.fps,e.config),n=o.checker.name,a=o.checker.objectPathLow,r=new THREE.ObjectLoader,s=e.scene,c=o.checker.nameLow,h=e.checkerManager.points;function p(){i.checkerGeometry=t?i.manager.checkerManager.checkerGeometryHigh:i.checkerGeometryLow,h.children.forEach(function(t,e){t.children.forEach(function(t,e){t.geometry=i.checkerGeometry})})}this.checkerHighGeometry=s.getObjectByName(n).geometry,i.checkerGeometryLow||r.load(a,function(t){i.checkerLoadginStarted=!0;var e=t.getObjectByName(c).geometry;e.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2)),i.checkerGeometryLow=e,p()}),i.checkerGeometryLow&&p(i.checkerGeometryLow)},optimizeTextures:function(t){if(!this.textureOptimizationDone){var e=this.manager,i=e.scene,o=e.config.board.texturesPath,n=this.boardImagePlane||new THREE.Mesh(new THREE.PlaneGeometry(9.3,6.2),new THREE.MeshPhongMaterial({map:THREE.ImageUtils.loadTexture(o+"BI.png"),side:THREE.DoubleSide,color:new THREE.Color(16777215)}));n.name="BI",n.rotateX(-Math.PI/2),this.boardImagePlane=n,i.getObjectByName(n.name)||i.add(n);var a=i.getObjectByName("Board_03"),r=i.getObjectByName("ShadowPlane");r.visible=!1,t?(a.visible=!0,r.visible=!0,i.getObjectByName(n.name).visible=!1):(a.visible=!1,r.visible=!1,i.getObjectByName(n.name).visible=!0)}}},Backgammon3DBoard.OptimizationManager=t}(),function(){function t(){0<arguments.length&&this.init.apply(this,arguments)}t.prototype.initProperties=function(){this.config={},this.isInited=!1,this.scene=null,this.clock=null,this.camera=null,this.loader=null,this.renderer=null,this.modelsPath=null,this.diceManager=null,this.domContainer=null,this.objectPicker=null,this.domContainer=null,this.cameraControls=null,this.checkerManager=null,this.onLoadComplete=function(){},this.animationFrameID=null,this.platformDetector=null,this.eventSource=null},t.prototype.init=function(t,e,i,o){i||console.error("Manger: Objects path is required!"),this.eventSource=e,this.mainPath=i,this.initialConfig=o||{rotationState:0,isColorSwitched:!1,isMirrored:!1,outPlaces:{placeOfOut1:0,placeOfOut2:25}},this.initConfig(i),this.initStats(),this.modelsPath=this.config||"",this.initDomContainer(t),this.initPlatformDetector(),this.initOptimizationManager(),this.initRenderer(),this.initCamera(),this.initLoader()},t.prototype.initConfig=function(t){this.config={mainPath:t,board:{objectPath:t+"board/board.json",texturesPath:t+"board/"},plane:{objectPath:t+"plane/opt-plane-01.json",texturesPath:t+"plane/",name:"Plane001"},checker:{objectPath:t+"checker/checker-high.json",objectPathLow:t+"checker/checker.json",texturesPath:t+"checker/",name:"Checker_High_001",nameLow:"Checker_01.001"},dice:{objectPath:t+"dice/dice.json",texturesPath:t+"dice/",animationsPath:t+"dice/animations/",name:"Dice_01"},double_cube:{texturesPath:t+"double_cube/",name:"double_cube"},renderer:{antialias:!0,alpha:!0,clearColor:5856617,shadowMap:{enabled:!0,soft:!0}},camera:{position:new THREE.Vector3(0,13,6),zoom:1.38}}},t.prototype.initDomContainer=function(t){this.domContainer=t||document.createElement("div")},t.prototype.initCamera=function(){var t=this.domContainer,e=t.clientWidth||t.width,i=t.clientHeight||t.height,o=this.config.camera;this.camera=new THREE.PerspectiveCamera(70,e/i,1,1e4),this.camera.position.copy(o.position),this.camera.lookAt(new THREE.Vector3(0,0,.3)),this.camera.zoom=o.zoom,this.camera.updateProjectionMatrix()},t.prototype.initScene=function(t){this.scene=t||new THREE.Scene},t.prototype.initRenderer=function(){this.renderer=this.platformDetector.getRenderer()},t.prototype.initLoader=function(){var t=this.config;this.loader=new Backgammon3DBoard.BoardLoader(t)},t.prototype.initMovementManager=function(){this.movementManager=new Backgammon3DBoard.MovementManager(this)},t.prototype.initPlatformDetector=function(){var t=this.domContainer,e=this.eventSource,i=this.config;this.platformDetector=new Backgammon3DBoard.PlatformDetector(t,e,i)},t.prototype.fullInit=function(t,e){this.initScene(t),this.initDiceManager(e),this.initEvents(),this.initLights(),this.initCameraControls(),this.scene.getObjectByName("Board_03")&&this.beautifyScene(),this.initCheckerManager(),this.initDoubleCube(),this.initMovementManager(),this.initTextWriter(),this.applyInitialConfig(),this.initGameHelper(),this.initAPI(),this.onLoadComplete(),this.isInited=!0},t.prototype.applyInitialConfig=function(){var t=this.initialConfig,e=this.checkerManager,i=t.isMirrored,o=t.rotationState;this.setRotationState(o,!1),i&&e.mirrorPositionMap()},t.prototype.initCameraControls=function(){var t=this.camera;this.cameraControls=THREE.OrbitControls?new THREE.OrbitControls(t,this.renderer.domElement):{},this.cameraControls.target=new THREE.Vector3(0,-.6,0)},t.prototype.initStats=function(){this.stats=new Stats},t.prototype.initOptimizationManager=function(){this.optimizationManager=new Backgammon3DBoard.OptimizationManager(this)},t.prototype.initCheckerManager=function(t){var e=this.scene,i=this.config.checker.name,o=e.getObjectByName(i);o.scale.set(.019,.019,.021),this.checkerManager=new Backgammon3DBoard.CheckerManager(this,t),e.remove(o)},t.prototype.initDiceManager=function(t){var e=this.modelsPath;this.diceManager=new Backgammon3DBoard.DiceManager(this,{mass:.3,diceParams:{x:.2,y:.2,z:.2}},e.dice,t)},t.prototype.initTextWriter=function(){this.textWriter=new Backgammon3DBoard.TextWriter(this)},t.prototype.initDoubleCube=function(){this.doubleCubeManager=new Backgammon3DBoard.DoubleCubeManager(this)},t.prototype.initEvents=function(){var n=this,t=this.domContainer,e=this.platformDetector;if(t){e.connectResize(function(t){n.stopRendering=!1;var e=n.renderer,i=n.domContainer.clientWidth||n.domContainer.width,o=n.domContainer.clientHeight||n.domContainer.height;n.platformDetector.isMobile&&(i=window.innerWidth,o=window.innerHeight),n.camera.aspect=i/o,n.camera.updateProjectionMatrix(),e.setSize(i,o),n.platformDetector.isMobile&&window.innerWidth<window.innerHeight||n.platformDetector.isMobile&&(n.camera.position.set(0,9.364,3.414),n.camera.lookAt(new THREE.Vector3(0,-.6,0)))})}},t.prototype.load=function(){var i=this,t=this.loader;t.config=this.config,t.loadAll(function(t,e){i.fullInit(t,e)})},t.prototype.beautifyScene=function(){var t=this.scene,e=t.getObjectByName("Object001");e.receiveShadow=!0,e.castShadow=!0;var i=t.getObjectByName("Board_03");i.receiveShadow=!0,i.castShadow=!0;var o,n=this.config.board.texturesPath,a=this.config.plane.texturesPath,r=THREE.ImageUtils.loadTexture(n+"bg_board_tex_2000px.jpg",function(){});r.minFilter=THREE.LinearFilter,(o=new THREE.MeshPhongMaterial({color:16777215})).map=r,o.bumpMap=r,o.bumpScale=.01,o.shininess=50,i.material=o;var s=new THREE.Mesh(new THREE.PlaneGeometry(8.9,5.9),new THREE.MeshBasicMaterial);s.name="ProjectionObject",s.rotateX(-Math.PI/2),s.position.y=.5,s.material.transparent=!0,s.material.opacity=0;var c=new THREE.Mesh(new THREE.PlaneGeometry(11.8,11.8),new THREE.MeshPhongMaterial({map:THREE.ImageUtils.loadTexture(a+"flor_alpha_01.png"),side:THREE.DoubleSide,color:new THREE.Color(16777215)}));c.rotateX(-Math.PI/2),c.material.shininess=150,c.material.specular=0,c.material.transparent=!0,c.name="ShadowPlane",t.add(s),t.add(c)},t.prototype.initLights=function(){var t=this.scene,e=new THREE.HemisphereLight(16777215,16777215);e.position.set(0,50,0),e.name="hLight",e.intensity=.1,e.visible=!0;var i=new THREE.DirectionalLight(16777215,.1);i.position.set(0,5,5),i.name="dLight1",i.castShadow=!1,i.shadowCameraNear=3,i.shadowCameraFar=15,i.shadowCameraLeft=-5,i.shadowCameraRight=5,i.shadowCameraTop=5,i.shadowCameraBottom=-5,i.shadowDarkness=.3,i.shadowBias=0,i.shadowMapHeight=i.shadowMapWidth=1024,i.intensity=.6,i.visible=!0,t.add(i);var o=new THREE.DirectionalLight(16777215,.1);o.position.set(5,5,-5),o.name="dLight2",o.castShadow=!this.platformDetector.isMobile,o.shadowCameraNear=3,o.shadowCameraFar=15,o.shadowCameraLeft=-5,o.shadowCameraRight=5,o.shadowCameraTop=5,o.shadowCameraBottom=-5,o.shadowDarkness=.3,o.shadowBias=0,o.shadowMapHeight=o.shadowMapWidth=1024,o.intensity=.6,o.visible=!0,o.position.z=-i.position.z,o.position.x=-i.position.x,t.add(o),t.add(e)},t.prototype.initGameHelper=function(){this.gameHelper=Backgammon3DBoard.GameHelper&&new Backgammon3DBoard.GameHelper(this)},t.prototype.start=function(){var o,n=this;!function t(){n.stats.begin();var e=Date.now(),i=e-o;try{n.animationFrameID=requestAnimationFrame(t),n.animate(i/20)}catch(t){console.error(t)}o=e,n.stats.end()}()},t.prototype.destroy=function(){this.platformDetector.isWeb&&(this.renderer.clear(),this.animationFrameID&&cancelAnimationFrame(this.animationFrameID.data&&this.animationFrameID.data.handleId||this.animationFrameID),this.renderer.domElement.addEventListener("dblclick",null,!1),this.platformDetector.removeEvents(),this.scene=null,this.camera=null,this.cameraControls=null,this.checkerManager=null,this.diceManager=null)},t.prototype.animate=function(t){var e=this;if(!e.stopRendering&&e.isInited){var i=e.renderer,o=e.scene,n=e.camera,a=e.diceManager,r=(e.physics,e.textWriter,e.optimizationManager,e.cameraControls||{update:function(){}});i.clear(),i.render(o,n),TWEEN.update(),a.update(t),r.update()}},t.prototype.setRotationState=function(t,e){this.movementManager.rotateBoard(+t,e)},t.prototype.setPlaceOfOut=function(t,e){this.checkerManager.setPlaceOfOut(t,e)},t.prototype.setDoubleCubeReadOnly=function(t){this.doubleCubeManager.setReadOnly(t)},t.prototype.setDegreeState=function(t,e){this.movementManager.setBoardDegreeState(+t,e)},t.prototype.initPhysics=function(){this.diceManager.getDice1(),this.diceManager.getDice2();var t=new DAC.PhysicsManager(this);this.physics=t},t.prototype.initAPI=function(){var i=this.movementManager,o=this.checkerManager,n=this.doubleCubeManager,a=this.diceManager,r=this.textWriter,s=o.checkerPicker,c=n.doubleCubePicker,h=this.gameHelper;this.api={set moved(t){s.moved=t},set maxStep(t){s.maxStep=t},set minStep(t){s.minStep=t},set allPossibleSteps(t){s.allPossibleSteps=t},set doubleCubeMoved(t){c.doubleCubeMoved=t},set playCheckerSound(t){s.playSound=t},set playDiceSound(t){a.playSound=t},set playDoubleCubeSound(t){n.playSound=t},setRotationState:function(t,e){t=+t,i.rotateBoard.apply(i,arguments)},setDegreeState:function(t,e){t=+t,i.setBoardDegreeState.apply(i,arguments)},setPlaceOfOut:function(t,e){o.setPlaceOfOut.apply(o,arguments)},setCheckersInPoint:function(t,e){o.setCheckersInPoint.apply(o,arguments)},move:function(t,e){s.moveCollection.apply(s,arguments)},setReadOnly:function(t,e){o.setReadOnly.apply(o,arguments)},switchColors:function(t){o.switchCheckersColors.apply(o,arguments),a.switchDiceColors.apply(a,arguments)},setMirroredState:function(t,e){o.mirrorPositionMap.apply(o,arguments)},setDoubleCubeReadOnly:function(t){n.setReadOnly.apply(n,arguments)},moveDoubleCubeTo:function(t,e){c.move.apply(c,arguments)},changeDoubleCubeTo:function(t,e,i){n.setDoubleCube.apply(n,arguments)},isDoubleCubeExist:function(t){n.isDoubleCubeExist.apply(n,arguments)},roll:function(t,e,i,o){a.drop.apply(a,arguments)},setDiceState:function(t,e){a.setDiceState.apply(a,arguments)},showPips:function(){r.showPips()},hidePips:function(){r.hidePips()},writePips:function(t,e){r.write(t,e)},setPips:function(t,e){r.write(0,""+t),r.write(1,""+e)},setPipsVisibility:function(t){r.setPipsVisibiliyState(t)},turnAllHintsOff:function(){h.turnOffAllLights()},setHintForIndex:function(t){h.turnLightOnForIndex(t)},removeHintForIndex:function(t){h.turnLightOffForIndex(t)},setHintsForIndexes:function(t,e){h.turnOffAllLights(),t[0]?(h.turnLightOnForIndex(t[0]),h.turnLightOnForIndex(t[1])):(h.turnLightOnForIndex(t),h.turnLightOnForIndex(e))},short:function(){h.short()}}},Backgammon3DBoard.Manager=t}(),"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports={Stats:Stats,Backgammon3DBoard:Backgammon3DBoard});
